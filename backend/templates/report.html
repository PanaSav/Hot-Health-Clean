<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Hot Health ‚Äî Report {{ID}}</title>
  <link rel="stylesheet" href="/styles.css"/>
  <style>
    .report-card{border:2px solid var(--aqua)}
    .kv p{margin:.25rem 0}
    .mono{font-family:ui-monospace,Menlo,Consolas,monospace}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#e6fffb;border:1px solid var(--aqua);font-size:12px;margin-left:.4rem}
    .note{color:var(--muted);font-size:.9rem}
    .qrwrap{display:flex;justify-content:center;align-items:center;padding:12px;border-radius:12px;border:2px dashed var(--aqua);background:#fbfdff}
    .qrwrap img{max-width:100%;height:auto}
    .dual h4{margin:.25rem 0 .5rem;color:#6b46c1}
    .dual pre{min-height:120px}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:.5rem}
  </style>
</head>
<body>
  <header><h1>Hot Health ‚Äî Report</h1></header>

  <main class="wrap">
    <section class="card report-card">
      <h2>Patient Report</h2>

      <!-- Link + Actions -->
      <div class="row">
        <div class="linkbox mono" id="linkBox">{{SELF_URL}}</div>
        <div class="actions">
          <a class="btn-outline" id="backBtn" style="display:{{SHOW_BACK}}" href="{{BACK_HREF}}">‚Ü©Ô∏é All Reports</a>
          <button class="btn-primary" id="copyBtn">üìã Copy Link</button>
          <button class="btn-aqua" onclick="window.print()">üñ®Ô∏è Print</button>
        </div>
      </div>

      <!-- Key Info -->
      <div class="row">
        <div class="grid" style="width:100%">
          <div class="block">
            <div class="kv">
              <p><b>Created:</b> {{DATE}}</p>
              <p>
                <b>Patient:</b> {{PATIENT_NAME}} {{BLOOD_PILL}}
              </p>
              <p><b>Email:</b> {{PATIENT_EMAIL}}</p>
              <p><b>Emergency:</b> {{EMER}}</p>
            </div>

            <hr/>

            <!-- Dual Transcripts -->
            <h3>Transcript</h3>
            <div class="dual">
              <div class="panel">
                <h4>Original</h4>
                <pre>{{TRANSCRIPT}}</pre>
              </div>
              <div class="panel">
                <h4>Translated</h4>
                <pre>{{TRANSLATED}}</pre>
              </div>
            </div>
          </div>

          <!-- QR Panel -->
          <div class="block">
            <h3>QR Code</h3>
            <div class="qrwrap">
              <img alt="QR to this report" src="/reports/{{ID}}/qrcode.png"/>
            </div>
            <p class="note" style="margin-top:.6rem">
              Scan to open this report on a phone.
            </p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    (function(){
      const btn = document.getElementById('copyBtn');
      const box = document.getElementById('linkBox');
      btn?.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(box.textContent.trim());
          btn.textContent = '‚úÖ Copied!';
          setTimeout(()=> btn.textContent='üìã Copy Link', 1200);
        } catch {
          btn.textContent = '‚ùå Copy failed';
          setTimeout(()=> btn.textContent='üìã Copy Link', 1200);
        }
      });
    })();
  </script>
</body>
</html>
